# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: `abi.encodePacked()` Hash Collision](#h-1-abiencodepacked-hash-collision)
  - [H-2: Storage Array Edited with Memory](#h-2-storage-array-edited-with-memory)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk](#l-1-centralization-risk)
  - [L-2: Unspecific Solidity Pragma](#l-2-unspecific-solidity-pragma)
  - [L-3: Address State Variable Set Without Checks](#l-3-address-state-variable-set-without-checks)
  - [L-4: Literal Instead of Constant](#l-4-literal-instead-of-constant)
  - [L-5: PUSH0 Opcode](#l-5-push0-opcode)
  - [L-6: Internal Function Used Only Once](#l-6-internal-function-used-only-once)
  - [L-7: Loop Contains `require`/`revert`](#l-7-loop-contains-requirerevert)
  - [L-8: Local Variable Shadows State Variable](#l-8-local-variable-shadows-state-variable)
  - [L-9: Uninitialized Local Variable](#l-9-uninitialized-local-variable)
  - [L-10: Unused Import](#l-10-unused-import)
  - [L-11: Unchecked Return](#l-11-unchecked-return)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 11 |
| Total nSLOC | 608 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| contracts/resolvers/profiles/IAddrResolver.sol | 5 |
| contracts/resolvers/profiles/IAddressResolver.sol | 12 |
| contracts/resolvers/profiles/IExtendedResolver.sol | 7 |
| contracts/resolvers/profiles/INameResolver.sol | 5 |
| contracts/reverseRegistrar/IStandaloneReverseRegistrar.sol | 5 |
| contracts/reverseResolver/AbstractReverseResolver.sol | 72 |
| contracts/reverseResolver/ChainReverseResolver.sol | 121 |
| contracts/reverseResolver/INameReverser.sol | 7 |
| contracts/utils/ENSIP19.sol | 83 |
| contracts/utils/HexUtils.sol | 163 |
| contracts/utils/NameCoder.sol | 128 |
| **Total** | **608** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 2 |
| Low | 11 |


# High Issues

## H-1: `abi.encodePacked()` Hash Collision

abi.encodePacked() should not be used with dynamic types when passing the result to a hash function such as `keccak256()`. Use `abi.encode()` instead which will pad items to 32 bytes, preventing hash collisions: https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode. (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). Unless there is a compelling reason, `abi.encode` should be preferred. If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` instead: https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739. If all arguments are strings and or bytes, `bytes.concat()` should be used instead.

<details><summary>1 Found Instances</summary>


- Found in contracts/utils/ENSIP19.sol [Line: 54](contracts/utils/ENSIP19.sol#L54)

	```solidity
	                abi.encodePacked(
	```

</details>



## H-2: Storage Array Edited with Memory

Storage reference is passed to a function with a memory parameter. This will not update the storage variable as expected. Consider using storage parameters instead.

<details><summary>2 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 80](contracts/reverseResolver/ChainReverseResolver.sol#L80)

	```solidity
	        fetch(
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 133](contracts/reverseResolver/ChainReverseResolver.sol#L133)

	```solidity
	        fetch(
	```

</details>



# Low Issues

## L-1: Centralization Risk

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>3 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 18](contracts/reverseResolver/ChainReverseResolver.sol#L18)

	```solidity
	    Ownable
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 59](contracts/reverseResolver/ChainReverseResolver.sol#L59)

	```solidity
	    function setGatewayURLs(string[] memory gateways) external onlyOwner {
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 66](contracts/reverseResolver/ChainReverseResolver.sol#L66)

	```solidity
	    function setGatewayVerifier(address verifier) external onlyOwner {
	```

</details>



## L-2: Unspecific Solidity Pragma

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>8 Found Instances</summary>


- Found in contracts/resolvers/profiles/IAddrResolver.sol [Line: 2](contracts/resolvers/profiles/IAddrResolver.sol#L2)

	```solidity
	pragma solidity >=0.8.4;
	```

- Found in contracts/resolvers/profiles/IAddressResolver.sol [Line: 2](contracts/resolvers/profiles/IAddressResolver.sol#L2)

	```solidity
	pragma solidity >=0.8.4;
	```

- Found in contracts/resolvers/profiles/IExtendedResolver.sol [Line: 2](contracts/resolvers/profiles/IExtendedResolver.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in contracts/resolvers/profiles/INameResolver.sol [Line: 2](contracts/resolvers/profiles/INameResolver.sol#L2)

	```solidity
	pragma solidity >=0.8.4;
	```

- Found in contracts/reverseRegistrar/IStandaloneReverseRegistrar.sol [Line: 2](contracts/reverseRegistrar/IStandaloneReverseRegistrar.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in contracts/reverseResolver/AbstractReverseResolver.sol [Line: 2](contracts/reverseResolver/AbstractReverseResolver.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 2](contracts/reverseResolver/ChainReverseResolver.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in contracts/reverseResolver/INameReverser.sol [Line: 2](contracts/reverseResolver/INameReverser.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-3: Address State Variable Set Without Checks

Check for `address(0)` when assigning values to address state variables.

<details><summary>2 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 53](contracts/reverseResolver/ChainReverseResolver.sol#L53)

	```solidity
	        gatewayVerifier = verifier;
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 67](contracts/reverseResolver/ChainReverseResolver.sol#L67)

	```solidity
	        gatewayVerifier = IGatewayVerifier(verifier);
	```

</details>



## L-4: Literal Instead of Constant

Define and use `constant` variables instead of using literals. If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>9 Found Instances</summary>


- Found in contracts/utils/HexUtils.sol [Line: 19](contracts/utils/HexUtils.sol#L19)

	```solidity
	        if (nibbles > 64 || end > hexString.length) {
	```

- Found in contracts/utils/HexUtils.sol [Line: 45](contracts/utils/HexUtils.sol#L45)

	```solidity
	        if (end - pos != 40) return (address(0), false); // wrong length
	```

- Found in contracts/utils/HexUtils.sol [Line: 140](contracts/utils/HexUtils.sol#L140)

	```solidity
	        hexString = new string(40);
	```

- Found in contracts/utils/HexUtils.sol [Line: 146](contracts/utils/HexUtils.sol#L146)

	```solidity
	        unsafeHex(12, dst, 40);
	```

- Found in contracts/utils/HexUtils.sol [Line: 170](contracts/utils/HexUtils.sol#L170)

	```solidity
	        if (dropZeroNibble && temp < 16) shift += 4;
	```

- Found in contracts/utils/HexUtils.sol [Line: 171](contracts/utils/HexUtils.sol#L171)

	```solidity
	        uint256 nibbles = 64 - (shift >> 2);
	```

- Found in contracts/utils/HexUtils.sol [Line: 214](contracts/utils/HexUtils.sol#L214)

	```solidity
	                    uint256 b = (word >> (shift -= 4)) & 15; // each nibble
	```

- Found in contracts/utils/NameCoder.sol [Line: 48](contracts/utils/NameCoder.sol#L48)

	```solidity
	        if (len == 66 && name[idx] == "[" && name[newIdx - 1] == "]") {
	```

- Found in contracts/utils/NameCoder.sol [Line: 177](contracts/utils/NameCoder.sol#L177)

	```solidity
	            size = 66;
	```

</details>



## L-5: PUSH0 Opcode

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>11 Found Instances</summary>


- Found in contracts/resolvers/profiles/IAddrResolver.sol [Line: 2](contracts/resolvers/profiles/IAddrResolver.sol#L2)

	```solidity
	pragma solidity >=0.8.4;
	```

- Found in contracts/resolvers/profiles/IAddressResolver.sol [Line: 2](contracts/resolvers/profiles/IAddressResolver.sol#L2)

	```solidity
	pragma solidity >=0.8.4;
	```

- Found in contracts/resolvers/profiles/IExtendedResolver.sol [Line: 2](contracts/resolvers/profiles/IExtendedResolver.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in contracts/resolvers/profiles/INameResolver.sol [Line: 2](contracts/resolvers/profiles/INameResolver.sol#L2)

	```solidity
	pragma solidity >=0.8.4;
	```

- Found in contracts/reverseRegistrar/IStandaloneReverseRegistrar.sol [Line: 2](contracts/reverseRegistrar/IStandaloneReverseRegistrar.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in contracts/reverseResolver/AbstractReverseResolver.sol [Line: 2](contracts/reverseResolver/AbstractReverseResolver.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 2](contracts/reverseResolver/ChainReverseResolver.sol#L2)

	```solidity
	pragma solidity ^0.8.17;
	```

- Found in contracts/reverseResolver/INameReverser.sol [Line: 2](contracts/reverseResolver/INameReverser.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/utils/ENSIP19.sol [Line: 2](contracts/utils/ENSIP19.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/utils/HexUtils.sol [Line: 2](contracts/utils/HexUtils.sol#L2)

	```solidity
	pragma solidity ^0.8.4;
	```

- Found in contracts/utils/NameCoder.sol [Line: 2](contracts/utils/NameCoder.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-6: Internal Function Used Only Once

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

<details><summary>5 Found Instances</summary>


- Found in contracts/utils/ENSIP19.sol [Line: 25](contracts/utils/ENSIP19.sol#L25)

	```solidity
	    function chainFromCoinType(
	```

- Found in contracts/utils/ENSIP19.sol [Line: 92](contracts/utils/ENSIP19.sol#L92)

	```solidity
	    function parseNamespace(
	```

- Found in contracts/utils/HexUtils.sol [Line: 13](contracts/utils/HexUtils.sol#L13)

	```solidity
	    function hexStringToBytes32(
	```

- Found in contracts/utils/NameCoder.sol [Line: 40](contracts/utils/NameCoder.sol#L40)

	```solidity
	    function readLabel(
	```

- Found in contracts/utils/NameCoder.sol [Line: 70](contracts/utils/NameCoder.sol#L70)

	```solidity
	    function namehash(
	```

</details>



## L-7: Loop Contains `require`/`revert`

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>1 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 129](contracts/reverseResolver/ChainReverseResolver.sol#L129)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

</details>



## L-8: Local Variable Shadows State Variable

Rename the local variable that shadows another state variable.

<details><summary>2 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 44](contracts/reverseResolver/ChainReverseResolver.sol#L44)

	```solidity
	        address _owner,
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 45](contracts/reverseResolver/ChainReverseResolver.sol#L45)

	```solidity
	        uint256 coinType,
	```

</details>



## L-9: Uninitialized Local Variable

Initialize all the variables. If a variable is meant to be initialized to zero, explicitly set it to zero to improve code readability.

<details><summary>2 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 129](contracts/reverseResolver/ChainReverseResolver.sol#L129)

	```solidity
	        for (uint256 i; i < count; i++) {
	```

- Found in contracts/utils/NameCoder.sol [Line: 135](contracts/utils/NameCoder.sol#L135)

	```solidity
	            for (uint256 i; i < n; i++) {
	```

</details>



## L-10: Unused Import

Redundant import statement. Consider removing it.

<details><summary>1 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 9](contracts/reverseResolver/ChainReverseResolver.sol#L9)

	```solidity
	import {INameReverser} from "./INameReverser.sol";
	```

</details>



## L-11: Unchecked Return

Function returns a value but it is ignored. Consider checking the return value.

<details><summary>6 Found Instances</summary>


- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 77](contracts/reverseResolver/ChainReverseResolver.sol#L77)

	```solidity
	        req.setTarget(l2Registrar); // target L2 registrar
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 78](contracts/reverseResolver/ChainReverseResolver.sol#L78)

	```solidity
	        req.setSlot(NAMES_SLOT).push(addr).follow().readBytes(); // names[addr]
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 79](contracts/reverseResolver/ChainReverseResolver.sol#L79)

	```solidity
	        req.setOutput(0);
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 128](contracts/reverseResolver/ChainReverseResolver.sol#L128)

	```solidity
	        req.setTarget(l2Registrar); // target L2 registrar
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 130](contracts/reverseResolver/ChainReverseResolver.sol#L130)

	```solidity
	            req.setSlot(NAMES_SLOT).push(addrs[start + i]).follow().readBytes(); // names[addr[i]]
	```

- Found in contracts/reverseResolver/ChainReverseResolver.sol [Line: 131](contracts/reverseResolver/ChainReverseResolver.sol#L131)

	```solidity
	            req.setOutput(uint8(i));
	```

</details>



